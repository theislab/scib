name: Build

on: [push, pull_request]

jobs:
    build:
        runs-on: ${{ matrix.os }}
        strategy:
            matrix:
                python: [ 3.7, 3.9 ]
                os: [ ubuntu-latest, macos-latest ]

        steps:
        -   uses: actions/checkout@v2
            with:
                fetch-depth: 0
        -   name: Set up Python ${{ matrix.python }}
            uses: actions/setup-python@v2
            with:
                python-version: ${{ matrix.python }}
        -   name: Install pip dependencies
            run: |
                python -m pip install --upgrade pip
                pip install build twine

        -   name: Build a binary wheel and a source tarball
            run: |
                python -m build --sdist --wheel --outdir dist/

        -   name: Twine check
            run: |
                twine check dist/*
