import numpy as np
import pandas as pd

import scib


def test_plot():
    data = {
        "ARI_cluster": {0: 0.951112722518898, 1: 0.262192519680191, 2: 0.1, 3: 0.2},
        "ASW_batch": {0: 0.9057019050549192, 1: 0.8448200803913499, 2: 0.7, 3: 0.3},
        "ASW_label": {0: 0.617242477834225, 1: 0.564448088407517, 2: 0.4, 3: 0.7},
        "NMI_cluster": {0: 0.9138665032024672, 1: 0.632615412598558, 2: 0.4, 3: 0.7},
        "PCR_batch": {0: 0.855878437307926, 1: 0.7125446098053699, 2: 0.6, 3: 0.5},
        "cLISI": {0: 1.0, 1: 0.9993835933509928, 2: 0.8, 3: 0.9},
        "cell_cycle_conservation": {
            0: 0.470498471863989,
            1: 0.741363581608263,
            2: 0.6,
            3: 0.8,
        },
        "graph_conn": {0: 0.971955345243732, 1: 0.944989571511962, 2: 0.8, 3: 0.7},
        "hvg_overlap": {0: 0.4772209890553079, 1: 0.2025893518406739, 2: 0.1, 3: 0.2},
        "iLISI": {0: 0.07924053136125, 1: 0.004064867867098, 2: 0.1, 3: 0.2},
        "isolated_label_F1": {
            0: 0.107692307692308,
            1: 0.106870229007634,
            2: 0.1,
            3: 0.3,
        },
        "isolated_label_silhouette": {
            0: 0.520902156829834,
            1: 0.550404392182827,
            2: 0.4,
            3: 0.6,
        },
        "kBET": {0: 0.3197709591957574, 1: 0.2183332674192387, 2: 0.1, 3: 0.2},
        "method": {0: "method1", 1: "method2", 2: "method3", 3: "method4"},
        "trajectory": {0: np.nan, 1: np.nan, 2: np.nan, 3: np.nan},
    }

    df = pd.DataFrame(data)
    df = df.melt(id_vars=["method"], var_name="metric", value_name="value")
    scib.pl.metrics(df)
    scib.pl.metrics(df[0:1])
